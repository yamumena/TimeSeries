---
title: "Actividad 3 Rotación de cargo"
author: "Yamuna Devi Mena Ramirez"
date: "2024-04-10"
output: rmdformats::robobook
---

<style>
body {
  text-align: justify;
}
</style> 

# **Caso rotación de cargo**

## **Problema planteado**

En una organización, se busca comprender y prever los factores que influyen en la rotación de empleados entre distintos cargos. La empresa ha recopilado datos históricos sobre el empleo de sus trabajadores, incluyendo variables como la antigüedad en el cargo actual, el nivel de satisfacción laboral, el salario actual, edad y otros factores relevantes. La gerencia planea desarrollar un modelo de regresión logística que permita estimar la probabilidad de que un empleado cambie de cargo en el próximo período y determinar cuales factores indicen en mayor proporción a estos cambios.

Con esta información, la empresa podrá tomar medidas proactivas para retener a su talento clave, identificar áreas de mejora en la gestión de recursos humanos y fomentar un ambiente laboral más estable y tranquilo. La predicción de la probabilidad de rotación de empleados ayudará a la empresa a tomar decisiones estratégicas informadas y a mantener un equipo de trabajo comprometido y satisfecho en sus roles actuales.

## **1. Selección de variables**

### **Enunciado**

Seleccione 3 variables categóricas (distintas de rotación) y 3 variables cuantitativas, que se consideren estén relacionadas con la rotación.
Nota: Debes justificar porque estas variables están relacionadas y que tipo de relación se espera entre ellas (Hipótesis).

### **Desarrollo**

#### **Instalación de paquetes y carga de datos**

```{r message=FALSE, warning=FALSE}
#install.packages("devtools") # solo la primera vez
#devtools::install_github("dgonxalex80/paqueteMODELOS", force =TRUE)
library(paqueteMODELOS)
data("rotacion")
```

#### **Vista general de los datos**

```{r message=FALSE, warning=FALSE}

library(dplyr)
glimpse(rotacion)

```

```{r}
# Contar los datos faltantes en cada columna
missing_values <- colSums(is.na(rotacion))

# Convertir los resultados en un marco de datos
missing_table <- as.data.frame(missing_values)

# Renombrar la columna
names(missing_table) <- "Datos_faltantes"

# Mostrar la tabla
print(missing_table)

```


#### **Observaciones generales de los datos**

* No hay valores nulos o faltantes en el DataSet
* 1470 registros y 24 variables
* 8 variables tipo chr y 16 variables tipo dbl
   
#### **Hipótesis de la selección de variables**

Considerando el desafío que representa la rotación de empleados, las hipótesis propuestas se basan en el análisis de las variables que podrían estar relacionadas. Este análisis se fundamenta en la revisión de la literatura existente sobre el tema.

La formulación de estas hipótesis parte de la premisa de que ciertos factores específicos pueden tener un impacto significativo en la rotacion de empleados entre distintos cargos. Al examinar cada variable y su posible influencia, se busca obtener una comprensión más profunda de los factores subyacentes que contribuyen.

#### **Variables categóricas**

* Satisfacción laboral (categórica ordinal): Cuando un empleado experimenta bajos niveles de satisfacción laboral, es más probable que busque cargos alternativos que puedan ofrecer un ambiente de trabajo más satisfactorio. En contraste, los empleados que están altamente satisfechos con su trabajo y entorno pueden preferir permanecer en sus roles actuales. La **hipótesis** plantea que la alta satisfacción laboral puede ser un factor determinante para no buscar un cambio de cargo, mientras que una baja satisfacción puede motivar a los empleados a considerar nuevas oportunidades laborales.

* Rendimiento_Laboral (Categórica ordinal): Los empleados con alto rendimiento laboral pueden sentirse más seguros y confiados en sus habilidades, lo que podría motivarlos a buscar oportunidades de ascenso hacia roles que les permitan aplicar y desarrollar aún más sus habilidades. Por otro lado, aquellos con un rendimiento laboral más bajo pueden estar menos inclinados a buscar un cambio de cargo, ya que pueden sentirse menos seguros sobre sus habilidades y menos motivados para buscar nuevas oportunidades. La **hipótesis** sugiere que un alto rendimiento laboral puede aumentar la probabilidad de que un empleado busque un cambio de cargo, mientras que un rendimiento laboral bajo puede disminuir el deseo de cambiar de posición.

* Equilibrio_Trabajo_Vida (Categórica ordinal): Los empleados con un bajo equilibrio entre trabajo y vida personal pueden buscar cargos laborales que les brinden una mejor distribución del tiempo, optando por roles con horarios más flexibles. Por otro lado, aquellos con un alto equilibrio trabajo-vida pueden estar más satisfechos con su situación laboral actual, lo que disminuiría su deseo de buscar otros cargos.Se plantea la **hipótesis** de que un equilibrio positivo entre trabajo y vida personal podría disminuir la propensión de los empleados a buscar un cambio de cargo. Por el contrario, un desequilibrio en esta área podría aumentar la probabilidad de considerar dicha rotación.

#### **Variables cuantitativas**

* Ingreso_Mensual: Los empleados que perciben un ingreso mensual insuficiente para sus necesidades o expectativas salariales pueden estar más motivados a buscar nuevos que ofrezcan una remuneración más adecuada. Por el contrario, aquellos que consideran que su ingreso actual es satisfactorio y está acorde con su posición laboral pueden ser menos propensos a rotar.La **hipótesis** sugiere que los empleados con ingresos mensuales más bajos podrían estar más inclinados a considerar un cambio de cargo, mientras que aquellos con ingresos más altos podrían ser menos propensos a hacerlo.

* Edad: La edad puede ser un factor determinante en la propensión a la rotación laboral, ya que los empleados más jóvenes pueden estar más inclinados a buscar nuevas oportunidades de desarrollo, mientras que los empleados mayores pueden valorar la estabilidad en sus roles actuales. Se plantea la **hipótesis** de que existe una relación inversa entre la edad y la rotación, sugiriendo que los empleados más jóvenes tienen una mayor probabilidad de cambiar de cargo en comparación con los empleados de mayor edad.

* Antigüedad_Cargo: Los empleados con más antigüedad en su cargo actual, pueden sentirse más inclinados a buscar ascensos hacia roles que les permitan aplicar y expandir su expertise. Por otro lado, aquellos con menos antigüedad pueden preferir permanecer en su posición actual mientras adquieren más experiencia y se sienten más seguros para asumir nuevas responsabilidades. La **hipótesis** plantea que la decisión de cambiar de posición está influenciada por la antigüedad en el cargo, sugiriendo que los empleados con más antigüedad podrían ser más propensos a buscar un cambio, mientras que aquellos con menos antigüedad pueden tener menos inclinación a hacerlo.

## 2. Análisis univariado

### Enunciado

Realiza un análisis univariado (caracterización) de la información contenida en la base de datos rotacion.


### Desarrollo

#### Anàlisis descriptivo para variables cuantitativas

```{r}
rotacion %>% 
  select(Antigüedad_Cargo, Ingreso_Mensual, Edad) %>% 
  summary()
```
#### Observaciones generales

* Para la antigüedad del cargo y el ingreso mensual, la mediana es ligeramente menor que la media, indicando una distribución sesgada hacia la derecha en ambos casos. Esto sugiere la presencia de valores atípicos significativos. Esto se confirma al comparar la mediana con los valores mínimo y máximo, donde la mediana está más cerca del mínimo que del máximo.

* En cuanto a la edad, aunque la mediana también es ligeramente menor que la media, la diferencia es menor en comparación con los casos anteriores. Esto sugiere una distribución menos sesgada hacia la derecha. Esta observación se refleja en la diferencia más significativa entre la mediana y el valor máximo que entre la mediana y el valor mínimo.

* Es posible que existan valores atípicos en este contexto, pero es importante destacar que estos casos tienen una explicación plausible y no representan necesariamente un erro

#### Histogramas para variables cuantitativas 

#### Antiguedad en el cargo

```{r message=FALSE, warning=FALSE}
ggplot(rotacion, aes(x=Antigüedad_Cargo)) + 
  geom_histogram(aes(y=..density..), bins=30, fill="skyblue", alpha=0.5) + 
  geom_density(color="blue", size=1) +
  geom_vline(aes(xintercept=mean(Antigüedad_Cargo, na.rm=TRUE)), color="red", linetype="dashed", size=1) + 
  geom_vline(aes(xintercept=median(Antigüedad_Cargo, na.rm=TRUE)), color="darkgreen", linetype="dashed", size=1) + 
  labs(title="Distribución de Antigüedad en el Cargo", x="Antigüedad en el Cargo", y="Densidad") +
  theme_minimal()
```

#### Observaciones

* Como se puede apreciar en el gráfico, se confirma el sesgo hacia la derecha que se esperaba.

* La antigüedad en el cargo varía de 0 a 18 años, con una mediana de 3 años. Esto sugiere que la mitad de los empleados han estado en sus roles actuales durante 3 años o menos. Este podría indicar una alta rotación de cargos o un crecimiento rápido de la empresa.

#### Ingreso mensual

```{r}
ggplot(rotacion, aes(x=Ingreso_Mensual)) + 
  geom_histogram(aes(y=..density..), bins=30, fill="lightgreen", alpha=0.5) + 
  geom_density(color="green", size=1) +
  geom_vline(aes(xintercept=mean(Ingreso_Mensual, na.rm=TRUE)), color="red", linetype="dashed", size=1) + 
  geom_vline(aes(xintercept=median(Ingreso_Mensual, na.rm=TRUE)), color="darkgreen", linetype="dashed", size=1) + 
  labs(title="Distribución del Salario Actual", x="Salario Actual", y="Densidad") +
  theme_minimal()
```

#### Observación

* El gráfico confirma el sesgo hacia la derecha que se anticipaba previamente.

* Los salarios mensuales presentan una amplia dispersión, oscilando desde 1009 hasta 19999, con una mediana de 4919. Esta variabilidad indica una diversidad significativa en los ingresos dentro de la organización, probablemente reflejando distintos roles, niveles de experiencia y responsabilidades.

#### Edad

```{r}
ggplot(rotacion, aes(x=Edad)) + 
  geom_histogram(aes(y=..density..), bins=30, fill="salmon", alpha=0.5) + 
  geom_density(color="red", size=1) +
  geom_vline(aes(xintercept=mean(Edad, na.rm=TRUE)), color="blue", linetype="dashed", size=1) + 
  geom_vline(aes(xintercept=median(Edad, na.rm=TRUE)), color="darkgreen", linetype="dashed", size=1) + 
  labs(title="Distribución de Edad", x="Edad", y="Densidad") +
  theme_minimal()
```

#### Observaciones

* Se puede observar el ligero sesgo hacia la derecha que se había anticipado previamente, aunque es bastante pequeño. Esta conclusión se refuerza al observar que la diferencia entre la mediana y la media no es significativa, lo que sugiere que la distribución se asemeja más a una distribución normal.

* La edad de los empleados abarca un rango de 18 a 60 años, y la mediana se sitúa en los 36 años. Esto indica que la fuerza laboral presenta una distribución de edades bastante equilibrada, con una combinación de empleados jóvenes y más experimentados.

#### Anàlisis descriptivo para variables cualitativas

#### Grfaicos de barras y Tablas de frecuencia
#### Rendimiento_Laboral

```{r}
table(rotacion$Rendimiento_Laboral)
```


```{r}
ggplot(rotacion, aes(x=factor(Rendimiento_Laboral))) + geom_bar(fill="lightblue") + labs(title="Distribución de Rendimiento Laboral", x="Rendimiento Laboral", y="Frecuencia")

```

#### Observación

*La mayoría de los empleados están clasificados en el nivel de rendimiento 3, lo cual se asocia con un alto rendimiento. Solo un pequeño porcentaje de empleados se encuentra en el nivel de rendimiento 4, que sugiere un rendimiento muy alto.

#### Satisfación_Laboral

```{r}
table(rotacion$Satisfación_Laboral)
```


```{r}
ggplot(rotacion, aes(x=factor(Satisfación_Laboral))) + geom_bar(fill="lightcoral") + labs(title="Distribución de Satisfacción Laboral", x="Satisfacción Laboral", y="Frecuencia")

```

#### Observación 

* Se observa que aproximadamente 600 empleados tienen una satisfacción laboral entre 1 y 2, lo cual puede indicar una satisfacción laboral no tan alta y posiblemente sugerir la posibilidad de rotación de cargos. Sin embargo, alrededor de 900 empleados tienen una satisfacción entre 3 y 4, lo que sugiere una satisfacción laboral considerablemente alta.

#### EEquilibrio_Trabajo_Vida

```{r}
table(rotacion$Equilibrio_Trabajo_Vida)
```


```{r}
ggplot(rotacion, aes(x=factor(Equilibrio_Trabajo_Vida))) + geom_bar(fill="lightgreen") + labs(title="Distribución de Equilibrio_Trabajo_Vida", x="Equilibrio_Trabajo_Vida", y="Frecuencia")

```

#### Observación

* A partir del gráfico y la tabla de frecuencias, se destaca que la mayoría de los empleados presentan un equilibrio trabajo-vida de nivel 3, lo cual sugiere un equilibrio satisfactorio y posiblemente indica que estas personas no desean rotación de cargos. Sin embargo, también se observa una cantidad limitada de empleados con niveles entre 1 y 2, lo que podría representar grupos de personas interesadas en una rotación de cargos.


## 3. Análisis bivariado

### Enunciado

Realiza un análisis de bivariado en donde la variable respuesta sea rotacion codificada de la siguiente manera (y=1 es si rotación, y=0 es no rotación). Con base en estos resultados identifique cuales son las variables determinantes de la rotación e interpretar el signo del coeficiente estimado. Compare estos resultados con la hipotesis planteada en el punto 2.


### Desarrollo


```{r}
#install.packages("glm2")
library(glm2)

# Asegurarse de que rotacion$Rotación sea numérica
rotacion$Rotación <- ifelse(rotacion$Rotación == "Si", 1, 0)

```


#### Aplicacción del modelo de regresión logistica para cada variable particular respecto a la variable rotación

#### Modelo para Ingreso Mensual

```{r}
# Modelo para Ingreso Mensual
modelo_ingreso_mensual <- glm(Rotación ~ Ingreso_Mensual, data = rotacion, family = binomial())
summary(modelo_ingreso_mensual)

```

#### Observaciones

* Null desviance y Residual desviance: La deviance residual es de 1253.1, mientras que la deviance nula es de 1298.6. Esto indica que la capacidad de predicción de si un empleado rotará o no en el modelo que incluye la variable de ingreso mensual es mayor que si se usara únicamente el modelo nulo, que considera solo el valor del intercepto.

* std error es pequeño, lo que significa que el valor de ingreso mensual es consistente en diferentes muestras.

* Coeficiente para Ingreso Mensual: El coeficiente estimado para el ingreso mensual fue de -1.271e-04. Su signo negativo indica una relación inversa entre la probabilidad de cambio de puesto o rotación laboral y el ingreso mensual del empleado. Es decir, a medida que aumenta el ingreso mensual, disminuye la probabilidad de cambio de puesto. Para verificar esta relación, evaluamos el estadístico z y el valor p asociado: Z = -7.191, P = 6.43e-13 ***. Este valor de z nos indica cuántas desviaciones estándar está el coeficiente por debajo de cero. Por su parte, el valor p es la probabilidad de que exista un valor de z igual a -7.191 si la hipótesis nula fuera cierta, es decir, si el ingreso mensual fuera cero. Al ser el valor p mucho menor que el nivel de significancia (0.05), es poco probable que el ingreso mensual sea cero. 

* a partir de los anteriores resultados se verifica que Se cumple la hipotesis generada para esta variable.

##### **Nota** 
Durante el análisis de las próximas variables, se considerarán las explicaciones previas de manera general, siempre que las condiciones se cumplan. En caso de que no se cumplan, se proporcionará una explicación adicional para aclarar el contexto específico de la variable en cuestión. Las variables que sean estadisticamente significativas serán las variables determinantes de rotación.

#### Modelo para Antiguedad del cargo

```{r}
# Modelo para Antigüedad en el Cargo
modelo_antiguedad_cargo <- glm(Rotación ~ Antigüedad_Cargo, data = rotacion, family = binomial(link = "logit"))
summary(modelo_antiguedad_cargo)
```

#### Observaciones

* Residual desviance < Null desviance : La deviance residual es de 1255.9, mientras que la deviance nula es de 1298.6. 

* Relación inversa: Antigüedad_Cargo: -0.14628    

* variable Antigüedad_Cargo es consistente: std error: 0.02424  

* estadistico z -6.033 

* P-value < 0.05, se rechaza la hipotesis nula : 1.61e-09 ***

* Relación estadisticamente significativa entre rotacion y antiguedad del cargo

* A partir de los anteriores resultados se verifica que Se cumple la hipotesis generada para esta variable.

#### Modelo para Edad

```{r}
modelo_edad <- glm(Rotación ~ Edad, data = rotacion, family = binomial(link = "logit"))
summary(modelo_edad)
```

#### Observaciones

* Residual desviance < Null desviance : La deviance residual es de 1259.1, mientras que la deviance nula es de 1298.6 

* Relación inversa: Edad: -0.05225   

* variable Edad es consistente: std error: 0.00870 

* estadistico z -6.006

* P-value < 0.05, se rechaza la hipotesis nula : 1.9e-09 ***

* Relación estadisticamente significativa entre rotacion y edad.

* A partir de los anteriores resultados se verifica que Se cumple la hipotesis generada para esta variable.

#### Modelo para Rendimiento laboral 

```{r}
modelo_rendimiento <- glm(Rotación ~ factor(Rendimiento_Laboral), data = rotacion, family = binomial(link = "logit"))


summary(modelo_rendimiento)
```

#### Observaciones

* Residual desviance = Null desviance : Null deviance: La deviance residual es de 1298.6, mientras que la deviance nula también es de 1298.6. Esto indica que tanto el modelo nulo como el modelo que incluye la variable de rendimiento laboral proporcionan predicciones similares en términos de ajuste al conjunto de datos. Es decir, la inclusión de la variable de rendimiento laboral no mejora significativamente la capacidad del modelo para explicar la variabilidad en los datos en comparación con solo considerar la constante.

* Relación no inversa: Rendimiento laboral: 0.02167, significa que entre mas grande es el rendimiento laboral los empleados buscan rotar de cargo.   

* variable rendimiento laboral es mayormente consistente: std error: 0.19564 

* estadistico z: 0.111

* P-value (0.912 ) > 0.05, No se rechaza la hipotesis nula, ya que hay una gran probabilidad de que exista ese estadistico z cuando rendimiento laboral sea cero, es decir puede que rendimiento laboral sea un coeficiente con valor 0, lo que sugiere que no tendria ninguna relación con la variable rotación.

* Relación estadisticamente NO significativa entre rotacion y rendimiento laboral.


* A partir de los anteriores resultados se verifica que no se cumple la hipotesis propuesta para esta variable.


#### Modelo para Satisfacción laboral 

```{r}
modelo_satisfaccion <- glm(Rotación ~ factor(Satisfación_Laboral), data = rotacion, family = binomial(link = "logit"))
summary(modelo_satisfaccion)
```

#### Observaciones

* Residual desviance < Null desviance : La deviance residual es de 1281.2, mientras que la deviance nula es de 1298.6 

* Relación inversa para los tres niveles: satisfacción laboral: -0.4092, -0.4028, -0.8401.  

* variable satisfacción laboral para los tres niveles es consistente: std error: 0.2137, 0.1899, 0.2033.

* estadistico z : -1.915, -2.122, -4.132

* P-value (0.0339 * , 3.59e-05 *** ) < 0.05 p-value(0.0555 .) > 0.05: En los resultados obtenidos, se observa que dos de los niveles de la variable categórica muestran valores p inferiores a 0.05, lo que indica que los coeficientes asociados son estadísticamente significativos. Esto significa que podemos rechazar la hipótesis nula de que estos coeficientes son iguales a cero. Sin embargo, para uno de los niveles, el valor p (0.0555) es ligeramente mayor que 0.05, lo que sugiere una tendencia hacia la significancia estadística, pero no alcanza el umbral convencional de significancia. En este caso, la evidencia es más débil para rechazar la hipótesis nula, o se requiere una investigación adicional para determinar su significancia.

* Relación estadisticamente significativa entre rotacion y la mayoria de niveles de satisfacción laboral.

* A partir de los anteriores resultados se verifica que Se cumple que para la mayoria de niveles de esta variable la hipotesis generada es correcta.

#### Modelo para Equilibrio_Trabajo_Vida

```{r}
modelo_Equilibrio_Trabajo_Vida <- glm(Rotación ~ factor(Equilibrio_Trabajo_Vida), data = rotacion, family = binomial(link = "logit"))
summary(modelo_Equilibrio_Trabajo_Vida)
```

#### Observaciones

* Residual desviance < Null desviance : La deviance residual es de 1284.5, mientras que la deviance nula es de 1298.6 

* Relación inversa para todos los niveles: Equilibrio_Trabajo_Vida: -0.8071, -1.0085, -0.7520.

* variable Equilibrio_Trabajo_Vida: para los tres niveles es consistente: std error: 0.2809, 0.2595, 0.3212.

* estadistico z : -2.873, -3.886, -2.341.

* P-value (0.004066 ** , 0.000102 *** , 0.019215 * ) < 0.05 : En los resultados obtenidos, se observa que todos los niveles de la variable muestran valores p inferiores a 0.05, lo que indica que los coeficientes asociados son estadísticamente significativos. Esto significa que podemos rechazar la hipótesis nula de que estos coeficientes son iguales a cero.

* Relación estadisticamente significativa entre rotacion y Equilibrio_Trabajo_Vida.

* A partir de los anteriores resultados se verifica que Se cumple que para Equilibrio_Trabajo_Vida la hipotesis generada es correcta.

## 4. Modelo entrenamiento y prueba

### Enunciado

Realice una partición en los datos de forma aleatoria donde 70% sea un set para entrenar el modelo y 30% para prueba. Estime un modelo logístico con la muestra del 70%. Muestre los resultados.


### Desarrollo

```{r}
# Cargar la librería necesaria para la división de datos
#install.packages("caTools")
```


```{r}

library(caTools)

# Establecer una semilla para reproducibilidad
set.seed(123)

# Dividir los datos en conjunto de entrenamiento y de prueba
split <- sample.split(rotacion$Rotación, SplitRatio = 0.7)

# Subconjunto de entrenamiento
train_set <- subset(rotacion, split == TRUE)

# Subconjunto de prueba
test_set <- subset(rotacion, split == FALSE)

# Ajustar el modelo de regresión logística usando el conjunto de entrenamiento
modelo_logistico <- glm(Rotación ~ Antigüedad_Cargo + Ingreso_Mensual + Edad + 
                          factor(Rendimiento_Laboral) + factor(Satisfación_Laboral) +
                          factor(Equilibrio_Trabajo_Vida), 
                        data = train_set, family = binomial(link = "logit"))

# Mostrar el resumen del modelo
summary(modelo_logistico)

```


### Observaciones:

* Antigüedad en el Cargo : El coeficiente es -9.542e-02 con un valor p de 0.002353 **, lo que indica que es estadísticamente significativo y que la antigüedad en el cargo está negativamente asociada con la rotación. Esto significa que por cada año adicional que un empleado pasa en su cargo, la probabilidad de rotación disminuye.

* Ingreso Mensual : El coeficiente es -7.425e-05 con un valor p de 0.010451 *, sugiriendo que hay una asociación negativa estadísticamente significativa entre el ingreso mensual y la rotación. Conforme aumenta el ingreso mensual, la probabilidad de rotación disminuye ligeramente.

* Edad : El coeficiente es -2.046e-02 con un valor p de 0.066355 ., lo cual es ligeramente mayor que el nivel de significancia lo que sugiere que no es estadísticamente significativo. Esto implica que no hay suficiente evidencia para afirmar que la edad tiene un efecto en la probabilidad de rotación dentro de este modelo.

* Rendimiento Laboral : El coeficiente es -2.906e-01 con un valor p de 0.284016, lo cual no es estadísticamente significativo. Esto significa que no podemos concluir que el rendimiento laboral "muy alto" afecte la rotación de manera significativa en comparación con el nivel de referencia (probablemente "alto").

* Satisfacción Laboral:
  - Nivel 2 : No es estadísticamente significativo con un valor p de 0.219767.
  - Nivel 3 : No es estadísticamente significativo con un valor p de 0.109506.
  - Nivel 4 : Es estadísticamente significativo con un valor p muy bajo (0.000121 ***), lo que indica que una alta satisfacción laboral está fuertemente asociada con una baja probabilidad de rotación.

* Equilibrio_Trabajo_Vida:

Todos los niveles son estadísticamente significativos con valores de  p muy bajos (0.003102 ** , 0.000309 *** , 0.008780 **), lo que indica que los niveles mas grandes de equilibrio_trabajo-vida estan relacionados con la mayor probabilidad de no rotar de puesto mientras que niveles mas bajos estan relacionados con la probabilidad de rotar de puesto.


### Resumen del Modelo:
- AIC (Criterio de Información de Akaike): El valor es 831.93. Este valor se usa para comparar modelos; cuanto más bajo, mejor. Sirve para equilibrar la bondad del ajuste del modelo con la simplicidad del mismo.
  
- Null deviance y Residual deviance: La diferencia entre la devianza nula y la devianza residual nos muestra cuánto ha mejorado el modelo al incluir las variables independientes. Una gran disminución sugiere que el modelo tiene un buen ajuste lo cual se cumple (831.93).


### Recomendaciones
La información obtenida del modelo es valiosa para diseñar intervenciones destinadas a reducir la rotación de personal. 

* Para abordar la antigüedad en el cargo y el tema del ingreso mensual, la empresa podría considerar estrategias que reconozcan y valoren la experiencia de sus empleados. Esto podría incluir ajustes salariales que reflejen adecuadamente la contribución y la dedicación de los empleados a lo largo del tiempo. Es importante investigar a fondo las razones por las cuales algunos empleados pueden sentirse insatisfechos con su nivel de remuneración actual, ya que esto puede influir en su disposición para cambiar de puesto. Además, respecto a la antigüedad en el cargo, la implementación de programas de reconocimiento y bonificaciones específicas para empleados de larga trayectoria podría ser una forma efectiva de incentivar la retención y reducir la rotación de personal. 

* Para mitigar la rotación de personal, es fundamental mejorar la satisfacción laboral de los empleados. Esto puede lograrse mediante la implementación de políticas y prácticas que promuevan un ambiente de trabajo positivo y gratificante. Entre estas medidas, se pueden incluir programas de desarrollo profesional, reconocimiento del desempeño, flexibilidad laboral y participación en la toma de decisiones. Además, es importante prestar atención al equilibrio entre el trabajo y la vida personal de los empleados. Proporcionar opciones como horarios flexibles, teletrabajo y programas de bienestar puede ayudar a reducir el estrés y mejorar la calidad de vida de los empleados, lo que a su vez puede disminuir la probabilidad de que busquen rotar de cargo. 

* Estadísticamente, los resultados indican dónde la empresa debe concentrar sus esfuerzos y qué factores no son tan relevantes para la rotación de empleados. La significancia estadística, junto con la dirección de los coeficientes, proporciona una base sólida para tales decisiones estratégicas.


## 5. Evaluación

### Enunciado

Evaluar el poder predictivo del modelo con base en la curva ROC y el AUC en el set de datos de prueba.


### Desarrollo


```{r}
#install.packages("pROC")
library(pROC)

# Usar el modelo para hacer predicciones en el conjunto de prueba
predicciones_prob <- predict(modelo_logistico, newdata = test_set, type = "response")

# Crear la curva ROC
roc_obj <- roc(test_set$Rotación, predicciones_prob)

# Calcular el área bajo la curva ROC
auc_obj <- auc(roc_obj)

# Crear el gráfico de la curva ROC
plot(roc_obj, main=sprintf("Curva ROC (AUC = %0.2f)", auc_obj))

# Agregar color al gráfico
plot(roc_obj, col="#1c61b6", main=sprintf("Curva ROC (AUC = %0.2f)", auc_obj))
abline(a=0, b=1, col="red")

# Mostrar el valor de AUC
print(auc_obj)

```

#### Observación 
El AUC (Área Bajo la Curva) es de 0.69. Esto significa que el modelo de regresión logística tiene una capacidad razonable para distinguir entre empleados que rotarán y los que no. En términos estadísticos, un AUC de 0.69 indica que hay un 69% de probabilidad de que el modelo clasifique correctamente un caso positivo aleatorio más alto que un caso negativo aleatorio.

## 6. Predicciones

### Enunciado

Realiza una predicción la probabilidad de que un individuo (hipotético) rote y defina un corte para decidir si se debe intervenir a este empleado o no (posible estrategia para motivar al empleado).

### Desarrollo

```{r}
# características del empleado hipotético
empleado_hipotetico <- data.frame(
  Antigüedad_Cargo = 2,          
  Ingreso_Mensual = 3000,         
  Edad = 35,                     
  Rendimiento_Laboral = 3,    
  Satisfación_Laboral = 3,    
  Equilibrio_Trabajo_Vida = 4 
)

#  predicción de probabilidad de rotación
probabilidad_rotacion <- predict(modelo_logistico, newdata = empleado_hipotetico, type = "response")

# Definir un umbral de corte 0.5
umbral_corte <- 0.5

if (probabilidad_rotacion > umbral_corte) {
  mensaje <- "La probabilidad de rotación es alta. Se recomienda intervenir con el empleado."
} else {
  mensaje <- "La probabilidad de rotación es baja. No es necesario intervenir con el empleado."
}

print(mensaje)
```

* Para este caso en particular no se necesitan estrategias para retener al empleado

## 7. Conclusiones

### Enunciado

En las conclusiones adicione una discución sobre cuál sería la estrategia para disminuir la rotación en la empresa (con base en las variables que resultaron significativas en el punto 3).

### Desarrollo

* Estadísticamente, los resultados indican dónde la empresa debe concentrar sus esfuerzos y qué factores no son tan relevantes para la rotación de empleados. La significancia estadística, junto con la dirección de los coeficientes, proporciona una base sólida para tales decisiones estratégicas.


* Para abordar la antigüedad en el cargo y el tema del ingreso mensual, la empresa podría considerar estrategias que reconozcan y valoren la experiencia de sus empleados. Esto podría incluir ajustes salariales que reflejen adecuadamente la contribución y la dedicación de los empleados a lo largo del tiempo. Es importante investigar a fondo las razones por las cuales algunos empleados pueden sentirse insatisfechos con su nivel de remuneración actual, ya que esto puede influir en su disposición para cambiar de puesto. Además, respecto a la antigüedad en el cargo, la implementación de programas de reconocimiento y bonificaciones específicas para empleados de larga trayectoria podría ser una forma efectiva de incentivar la retención y reducir la rotación de personal. 

* Para mitigar la rotación de personal, es fundamental mejorar la satisfacción laboral de los empleados. Esto puede lograrse mediante la implementación de políticas y prácticas que promuevan un ambiente de trabajo positivo y gratificante. Entre estas medidas, se pueden incluir programas de desarrollo profesional, reconocimiento del desempeño, flexibilidad laboral y participación en la toma de decisiones. Además, es importante prestar atención al equilibrio entre el trabajo y la vida personal de los empleados. Proporcionar opciones como horarios flexibles, teletrabajo y programas de bienestar puede ayudar a reducir el estrés y mejorar la calidad de vida de los empleados, lo que a su vez puede disminuir la probabilidad de que busquen rotar de cargo. 





